***这算是第一次做相对复杂的手工运维工作了。*** 今天复盘一下上周做的一些关于手工运维的工作。目的有二。

- 回顾一下学到了什么。
- 如果想做好手工运维，需要具备哪些知识。

***背景是这样的***

目前的storm计算项目需要一个实验集群，去实现实验性的功能，比如数据回放，性能测试，这次主要做的是数据回放功能测试。storm计算项目分为两个仓库，第一个是配置仓库，负责安装各种依赖软件，第二个仓库是提交计算任务的。

以此为背景。

***首先，需要将storm稳定的运行***

其中一台机器运行nimbus，剩下的七台机器运行。

- 首先，命令行功底很差，对linux的理解很差。所以找不到做前端开发时流畅的感觉。

刚上来发现找不到java，原因：这八台机器上没有java8。所以我把java_home换到了这几台机器的java7上面，结果还是有问题，**去Google，得到的信息是storm需要java6以上的版本，所以按道理java7也ok？**。后来实在找不到原因，就叫其他组管机器的同事将这八台机器批量升级到了java8，后来可以启动了。此处我觉得可以注意的是：

- 要主动的去保证环境的统一性。

后面第二个问题是一个报警，显示磁盘占用过多。后来发现storm的多语言通信产生了很多的临时文件，后来在上线脚本中加入了删除上线临时文件的命令，报警就解除了。这里需要注意：

- 了解各种报警的含义。

再提交了计算任务再停掉某台机器上的supervisor后，重启计算任务，这台机器上的supervisor就陷入反复重启，强重启deamon服务也不行。后来因为此supervisor上的data文件里存有了历史计算任务的相关文件，所以简单来讲，它懵了，所以把data/supervisor文件夹删除，就可以了。

- 我眼中的reset不是真正的reset。

而且在杀deamon守护的时候，明明执行了svc -d但是进程还在，这时需要killall java才能彻底杀掉supervisor进程。问了鑫哥为什么，鑫哥说了一堆我也没太理解。

- 总之，linux进程运行方式需要系统学习下。

***摸清了storm运行套路***

现在基本可以无后顾之忧的提交计算任务了。

有一个很傻叉的地方是。当我这个地方有疑惑的时候，去问鑫哥这个地方这么写ok吗，因为构架是他设计的，所以他给了我正确的写法，但是问题是，当我使用了正确的写法之后，突然就报错了，当时就怀疑人生了。后来发现是因为写法正确了，计算可以进行到下面的某一节点，在执行这一节点的代码的时候，在这个节点上报错了。**所以报错跟当前代码本身没有关系，视野还是太狭隘了。**

***总之***

要做好手工运维的话：

- linux基础要好，进程，命令行，shell。
- 要有分布式的视野。
- 多踩坑。

